

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
  
    <title>3.2. 网格搜索: 找到最好的估计器参数 &#8212; scikit-learn 0.17.1 documentation</title>
  <!-- htmltitle is before nature.css - we use this hack to load bootstrap first -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../_static/css/bootstrap.min.css" media="screen" />
  <link rel="stylesheet" href="../_static/css/bootstrap-responsive.css"/>

    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.17.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.2.4.1.1. sklearn.linear_model.ElasticNetCV" href="generated/sklearn.linear_model.ElasticNetCV.html" />
    <link rel="prev" title="3.1. Cross-validation: 评估 estimator 的性能" href="cross_validation.html" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="../_static/js/bootstrap.min.js" type="text/javascript"></script>
  <link rel="canonical" href="http://scikit-learn.org/stable/modules/grid_search.html" />

  <script type="text/javascript">
    $("div.buttonNext, div.buttonPrevious").hover(
       function () {
           $(this).css('background-color', '#FF9C34');
       },
       function () {
           $(this).css('background-color', '#A7D6E2');
       }
    );
  </script>

  </head>
  <body>

<div class="header-wrapper">
    <div class="header">
        <p class="logo"><a href="../index.html">
            <img src="../_static/scikit-learn-logo-small.png" alt="Logo"/>
        </a>
        </p><div class="navbar">
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="../install.html">Installation</a></li>
                <li class="btn-li"><div class="btn-group">
              <a href="../documentation.html">Documentation</a>
              <a class="btn dropdown-toggle" data-toggle="dropdown">
                 <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
            <li class="link-title">Scikit-learn 0.17 (stable)</li>
            <li><a href="../tutorial/index.html">Tutorials</a></li>
            <li><a href="../user_guide.html">User guide</a></li>
            <li><a href="classes.html">API</a></li>
            <li><a href="../faq.html">FAQ</a></li>
            <li><a href="../developers.html">Contributing</a></li>
            <li class="divider"></li>
                <li><a href="http://scikit-learn.org/dev/documentation.html">Scikit-learn 0.18 (development)</a></li>
                <li><a href="http://scikit-learn.org/0.16/documentation.html">Scikit-learn 0.16</a></li>
				<li><a href="../_downloads/user_guide.pdf">PDF documentation</a></li>
              </ul>
            </div>
        </li>
            <li><a href="../auto_examples/index.html">Examples</a></li>
            </ul>

            <div class="search_form">
                <div id="cse" style="width: 100%;"></div>
            </div>
        </div> <!-- end navbar --></div>
</div>


<!-- Github "fork me" ribbon -->
<a href="https://github.com/lzjqsdd/scikit-learn-doc-cn">
  <img class="fork-me"
       style="position: absolute; top: 0; right: 0; border: 0;"
       src="../_static/img/forkme.png"
       alt="Fork me on GitHub" />
</a>

<div class="content-wrapper">
    <div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
        <div class="rel">
    

  <!-- rellinks[1:] is an ugly hack to avoid link to module
  index -->
        <div class="rellink">
        <a href="cross_validation.html"
        accesskey="P">Previous
        <br/>
        <span class="smallrellink">
        3.1. Cross-va...
        </span>
            <span class="hiddenrellink">
            3.1. Cross-validation: 评估 estimator 的性能
            </span>
        </a>
        </div>

    <!-- Ad a link to the 'up' page -->
        <div class="spacer">
        &nbsp;
        </div>
        <div class="rellink">
        <a href="../model_selection.html">
        Up
        <br/>
        <span class="smallrellink">
        3. Model sele...
        </span>
            <span class="hiddenrellink">
            3. Model selection and evaluation
            </span>
            
        </a>
        </div>
    </div>
    
      <p class="doc-version">This documentation is for scikit-learn <strong>version 0.17.1</strong> &mdash; <a href="http://scikit-learn.org/stable/support.html#documentation-resources">Other versions</a></p>
    <p class="citing">If you use the software, please consider <a href="../about.html#citing-scikit-learn">citing scikit-learn</a>.</p>
    <ul>
<li><a class="reference internal" href="#">3.2. 网格搜索: 找到最好的估计器参数</a><ul>
<li><a class="reference internal" href="#exhaustive-grid-search">3.2.1. 穷尽网格搜索(Exhaustive Grid Search)</a></li>
<li><a class="reference internal" href="#randomized-parameter-optimization">3.2.2. Randomized Parameter Optimization (随机参数优化)</a></li>
<li><a class="reference internal" href="#tips-for-parameter-search">3.2.3. Tips for parameter search (参数搜索的技巧)</a><ul>
<li><a class="reference internal" href="#specifying-an-objective-metric">3.2.3.1. Specifying an objective metric (设定一个评估标准)</a></li>
<li><a class="reference internal" href="#composite-estimators-and-parameter-spaces">3.2.3.2. Composite estimators and parameter spaces (组合评估器和参数空间)</a></li>
<li><a class="reference internal" href="#model-selection-development-and-evaluation">3.2.3.3. Model selection: development and evaluation (模型选择：开发和评估)</a></li>
<li><a class="reference internal" href="#parallelism">3.2.3.4. Parallelism (并行化)</a></li>
<li><a class="reference internal" href="#robustness-to-failure">3.2.3.5. Robustness to failure (失败的鲁棒性)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#alternatives-to-brute-force-parameter-search">3.2.4. Alternatives to brute force parameter search (暴力参数搜索的替代)</a><ul>
<li><a class="reference internal" href="#model-specific-cross-validation">3.2.4.1. Model specific cross-validation (模型特定的交叉验证)</a></li>
<li><a class="reference internal" href="#information-criterion">3.2.4.2. Information Criterion (信息规范)</a></li>
<li><a class="reference internal" href="#out-of-bag-estimates">3.2.4.3. Out of Bag Estimates 实用化的评估</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
</div>

<input type="checkbox" id="nav-trigger" class="nav-trigger" checked />
<label for="nav-trigger"></label>




      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="grid-search">
<span id="id1"></span><h1>3.2. 网格搜索: 找到最好的估计器参数<a class="headerlink" href="#grid-search" title="Permalink to this headline">¶</a></h1>
<p>Parameters that are not directly learnt within estimators can be set by
searching a parameter space for the best <a class="reference internal" href="cross_validation.html#cross-validation"><span class="std std-ref">Cross-validation: 评估 estimator 的性能</span></a> score.
Typical examples include <code class="docutils literal"><span class="pre">C</span></code>, <code class="docutils literal"><span class="pre">kernel</span></code> and <code class="docutils literal"><span class="pre">gamma</span></code> for Support Vector
Classifier, <code class="docutils literal"><span class="pre">alpha</span></code> for Lasso, etc.
对于估计器不能够直接学习的参数，可以设定一个搜索空间，
找到能够取得最高分数 <a class="reference internal" href="cross_validation.html#cross-validation"><span class="std std-ref">Cross-validation: 评估 estimator 的性能</span></a> 的参数。典型的例子有支持向量机分类器中的</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">C</span></code>, <code class="docutils literal"><span class="pre">kernel</span></code> 和 <code class="docutils literal"><span class="pre">gamma</span></code>， Lasso 中的 <code class="docutils literal"><span class="pre">alpha</span></code> 等。</div></blockquote>
<p>Any parameter provided when constructing an estimator may be optimized in this
manner.  Specifically, to find the names and current values for all parameters
for a given estimator, use (当构建一个估计器时，任何参数都可以使用这种方式来优化。特别的，
使用下面的方法来得到给定估计器所有参数的名称和当前的值):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
<p>Such parameters are often referred to as <em>hyperparameters</em> (particularly in
Bayesian learning), distinguishing them from the parameters optimised in a
machine learning procedure.
这些参数通常称之为 <em>超参数</em> (特别是在 Bayesian 学习中)，这使得他们和
机器学习过程中红优化的参数区别开来。</p>
<p>A search consists of(一个搜索包括):</p>
<ul class="simple">
<li>an estimator (regressor or classifier such as <code class="docutils literal"><span class="pre">sklearn.svm.SVC()</span></code>) 一个估计器 (回归或者分类器，例如 <code class="docutils literal"><span class="pre">sklearn.svm.SVC()</span></code>);</li>
<li>a parameter space (参数空间);</li>
<li>a method for searching or sampling candidates (一个用于搜索和采样候选值的方法);</li>
<li>a cross-validation scheme (交叉验证策略); and</li>
<li>a <a class="reference internal" href="#gridsearch-scoring"><span class="std std-ref">score function</span></a> (一个分数计算函数 <a class="reference internal" href="#gridsearch-scoring"><span class="std std-ref">score function</span></a> ).</li>
</ul>
<p>Some models allow for specialized, efficient parameter search strategies,
<a class="reference internal" href="#alternative-cv"><span class="std std-ref">outlined below</span></a>.
Two generic approaches to sampling search candidates are provided in
scikit-learn: for given values, <a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> exhaustively considers
all parameter combinations, while <a class="reference internal" href="generated/sklearn.grid_search.RandomizedSearchCV.html#sklearn.grid_search.RandomizedSearchCV" title="sklearn.grid_search.RandomizedSearchCV"><code class="xref py py-class docutils literal"><span class="pre">RandomizedSearchCV</span></code></a> can sample a
given number of candidates from a parameter space with a specified
distribution. After describing these tools we detail
<a class="reference internal" href="#grid-search-tips"><span class="std std-ref">best practice</span></a> applicable to both approaches.
一些模型允许使用特别的，高效的参数搜索策略，<a class="reference internal" href="#alternative-cv"><span class="std std-ref">outlined below</span></a>。
在 scikit-learn 中给出了两种通用的用于搜索候选区间的方法：对于给定的值，
<a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> 会搜索全部的参数组合，而 <a class="reference internal" href="generated/sklearn.grid_search.RandomizedSearchCV.html#sklearn.grid_search.RandomizedSearchCV" title="sklearn.grid_search.RandomizedSearchCV"><code class="xref py py-class docutils literal"><span class="pre">RandomizedSearchCV</span></code></a>
会从参数空间中使用特定的分布给出一些参数的候选用于搜索。在描述这些工具之后，
<a class="reference internal" href="#grid-search-tips"><span class="std std-ref">best practice</span></a> 详细讲解如何用用这两种方法。</p>
<div class="section" id="exhaustive-grid-search">
<h2>3.2.1. 穷尽网格搜索(Exhaustive Grid Search)<a class="headerlink" href="#exhaustive-grid-search" title="Permalink to this headline">¶</a></h2>
<p>The grid search provided by <a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> exhaustively generates
candidates from a grid of parameter values specified with the <code class="docutils literal"><span class="pre">param_grid</span></code>
parameter. For instance, the following <code class="docutils literal"><span class="pre">param_grid</span></code> (由 <a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> 给出的
网格搜索方法会穷尽搜索由 <code class="docutils literal"><span class="pre">param_grid</span></code> 参数设定网格中所有的候选项):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">]},</span>
  <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">],</span> <span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">]},</span>
 <span class="p">]</span>
</pre></div>
</div>
<p>specifies that two grids should be explored: one with a linear kernel and
C values in [1, 10, 100, 1000], and the second one with an RBF kernel,
and the cross-product of C values ranging in [1, 10, 100, 1000] and gamma
values in [0.001, 0.0001].
特别的，两个网格会被搜索：一个拥有线性核而且 C 的值在 [1, 10, 100, 1000]，
而另一个拥有 RBF 核，C 的值在 [1, 10, 100, 1000] 而 gamma 的取值在 [0.001, 0.0001] 中。</p>
<p>The <a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> instance implements the usual estimator API: when
“fitting” it on a dataset all the possible combinations of parameter values are
evaluated and the best combination is retained.
<a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> 实例实现了通常的估计器 API：
当使用其在某个数据集上进行拟合，评估所有可能的参数值的组合结果时，能够获得最好的参数组合。</p>
<div class="topic">
<p class="topic-title first">Examples (例子):</p>
<ul class="simple">
<li>See <a class="reference internal" href="../auto_examples/model_selection/grid_search_digits.html#example-model-selection-grid-search-digits-py"><span class="std std-ref">Parameter estimation using grid search with cross-validation</span></a> for an example of
Grid Search computation on the digits dataset. (查看 <a class="reference internal" href="../auto_examples/model_selection/grid_search_digits.html#example-model-selection-grid-search-digits-py"><span class="std std-ref">Parameter estimation using grid search with cross-validation</span></a>
是一个在数字数据集上进行网格搜索的例子。)</li>
<li>See <a class="reference internal" href="../auto_examples/model_selection/grid_search_text_feature_extraction.html#example-model-selection-grid-search-text-feature-extraction-py"><span class="std std-ref">Sample pipeline for text feature extraction and evaluation</span></a> for an example
of Grid Search coupling parameters from a text documents feature
extractor (n-gram count vectorizer and TF-IDF transformer) with a
classifier (here a linear SVM trained with SGD with either elastic
net or L2 penalty) using a <code class="xref py py-class docutils literal"><span class="pre">pipeline.Pipeline</span></code> instance. (查看 <a class="reference internal" href="../auto_examples/model_selection/grid_search_text_feature_extraction.html#example-model-selection-grid-search-text-feature-extraction-py"><span class="std std-ref">Sample pipeline for text feature extraction and evaluation</span></a>
是一个在文本特征提取器上使用网格搜索的例子 (n-gram 计数向量化和 TF_IDF 转换) 和一个分类器 (一个使用 SGD 训练、使用 elastic net 或者 L2 损失函数的线性 SVM)，
使用 <code class="xref py py-class docutils literal"><span class="pre">pipeline.Pipeline</span></code> 的实例)。</li>
</ul>
</div>
</div>
<div class="section" id="randomized-parameter-optimization">
<span id="randomized-parameter-search"></span><h2>3.2.2. Randomized Parameter Optimization (随机参数优化)<a class="headerlink" href="#randomized-parameter-optimization" title="Permalink to this headline">¶</a></h2>
<p>While using a grid of parameter settings is currently the most widely used
method for parameter optimization, other search methods have more
favourable properties.
使用一个网格的参数设置并搜索是当前常用的参数优化手段，然而一些其他的搜索方法也有一些自己特有的性质。</p>
<p><a class="reference internal" href="generated/sklearn.grid_search.RandomizedSearchCV.html#sklearn.grid_search.RandomizedSearchCV" title="sklearn.grid_search.RandomizedSearchCV"><code class="xref py py-class docutils literal"><span class="pre">RandomizedSearchCV</span></code></a> implements a randomized search over parameters,
where each setting is sampled from a distribution over possible parameter values.
This has two main benefits over an exhaustive search(<a class="reference internal" href="generated/sklearn.grid_search.RandomizedSearchCV.html#sklearn.grid_search.RandomizedSearchCV" title="sklearn.grid_search.RandomizedSearchCV"><code class="xref py py-class docutils literal"><span class="pre">RandomizedSearchCV</span></code></a> 实现了一个在参数上随机搜索的方法，
每次使用的参数是使用一个特别的分布从允许的参数列表中选择。相比于群举搜索，有以下好处):</p>
<ul class="simple">
<li>A budget can be chosen independent of the number of parameters and possible values. (可以独立地控制计算代价，与参数空间的选择无关)</li>
<li>Adding parameters that do not influence the performance does not decrease efficiency. (增加参数但不会影响结果或者降低性能)</li>
</ul>
<p>Specifying how parameters should be sampled is done using a dictionary, very
similar to specifying parameters for <a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a>. Additionally,
a computation budget, being the number of sampled candidates or sampling
iterations, is specified using the <code class="docutils literal"><span class="pre">n_iter</span></code> parameter.
For each parameter, either a distribution over possible values or a list of
discrete choices (which will be sampled uniformly) can be specified (使用字典来设定如何进行参数采样，
和使用 <a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> 非常类似。此外，使用 <code class="docutils literal"><span class="pre">n_iter</span></code> 参数可以通过设定候选采样参数的数量来设定计算预算。
对于这些参数，或者是允许值的分布或者是离散值的列表（将会按照均一概率采样）来进行设定):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="p">(</span><span class="n">scale</span><span class="o">=.</span><span class="mi">1</span><span class="p">),</span>
  <span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span> <span class="s1">&#39;class_weight&#39;</span><span class="p">:[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]}]</span>
</pre></div>
</div>
<p>This example uses the <code class="docutils literal"><span class="pre">scipy.stats</span></code> module, which contains many useful
distributions for sampling parameters, such as <code class="docutils literal"><span class="pre">expon</span></code>, <code class="docutils literal"><span class="pre">gamma</span></code>,
<code class="docutils literal"><span class="pre">uniform</span></code> or <code class="docutils literal"><span class="pre">randint</span></code>. (这个例子使用了 <code class="docutils literal"><span class="pre">scipy.stats</span></code> 模块，这个模块包括了许多可以用于参数采样的分布，如
<code class="docutils literal"><span class="pre">expon</span></code>, <code class="docutils literal"><span class="pre">gamma</span></code>, <code class="docutils literal"><span class="pre">uniform</span></code> 或者 <code class="docutils literal"><span class="pre">randint</span></code>)
In principle, any function can be passed that provides a <code class="docutils literal"><span class="pre">rvs</span></code> (random
variate sample) method to sample a value. A call to the <code class="docutils literal"><span class="pre">rvs</span></code> function should
provide independent random samples from possible parameter values on
consecutive calls. (实际上，给任意函数传入一个 <code class="docutils literal"><span class="pre">rvs</span></code> (随机变量采样) 方法来采样获得一个值。调用 <code class="docutils literal"><span class="pre">rvs</span></code> 的函数在
连续调用时，应该提供独立的随机采样)</p>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The distributions in <code class="docutils literal"><span class="pre">scipy.stats</span></code> do not allow specifying a random
state. Instead, they use the global numpy random state, that can be seeded
via <code class="docutils literal"><span class="pre">np.random.seed</span></code> or set using <code class="docutils literal"><span class="pre">np.random.set_state</span></code>. (在 <code class="docutils literal"><span class="pre">scipy.stats</span></code> 中并不允许设定特有的随机状态，
而是使用全局的 numpy 的随机状态，可以使用 <code class="docutils literal"><span class="pre">np.random.seed</span></code> 获得对应的 seed，或者使用 <code class="docutils literal"><span class="pre">np.random.set_state</span></code> 来设定。)</p>
</div>
</div></blockquote>
<p>For continuous parameters, such as <code class="docutils literal"><span class="pre">C</span></code> above, it is important to specify
a continuous distribution to take full advantage of the randomization. This way,
increasing <code class="docutils literal"><span class="pre">n_iter</span></code> will always lead to a finer search.
对于连续的参数，比如上面的 <code class="docutils literal"><span class="pre">C</span></code>，设定一个连续的分布使得随机性的全部好处发挥出来十分重要。
这种方式下，增加 <code class="docutils literal"><span class="pre">n_iter</span></code> 总会得到一个更好的搜索结果。</p>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><a class="reference internal" href="../auto_examples/model_selection/randomized_search.html#example-model-selection-randomized-search-py"><span class="std std-ref">Comparing randomized search and grid search for hyperparameter estimation</span></a> compares the usage and efficiency
of randomized search and grid search. (<a class="reference internal" href="../auto_examples/model_selection/randomized_search.html#example-model-selection-randomized-search-py"><span class="std std-ref">Comparing randomized search and grid search for hyperparameter estimation</span></a> 比较了
随机搜索和网格搜索的使用和效率。)</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">References:</p>
<ul class="simple">
<li>Bergstra, J. and Bengio, Y.,
Random search for hyper-parameter optimization,
The Journal of Machine Learning Research (2012)</li>
</ul>
</div>
</div>
<div class="section" id="tips-for-parameter-search">
<span id="grid-search-tips"></span><h2>3.2.3. Tips for parameter search (参数搜索的技巧)<a class="headerlink" href="#tips-for-parameter-search" title="Permalink to this headline">¶</a></h2>
<div class="section" id="specifying-an-objective-metric">
<span id="gridsearch-scoring"></span><h3>3.2.3.1. Specifying an objective metric (设定一个评估标准)<a class="headerlink" href="#specifying-an-objective-metric" title="Permalink to this headline">¶</a></h3>
<p>By default, parameter search uses the <code class="docutils literal"><span class="pre">score</span></code> function of the estimator
to evaluate a parameter setting. These are the
<a class="reference internal" href="generated/sklearn.metrics.accuracy_score.html#sklearn.metrics.accuracy_score" title="sklearn.metrics.accuracy_score"><code class="xref py py-func docutils literal"><span class="pre">sklearn.metrics.accuracy_score</span></code></a> for classification and
<a class="reference internal" href="generated/sklearn.metrics.r2_score.html#sklearn.metrics.r2_score" title="sklearn.metrics.r2_score"><code class="xref py py-func docutils literal"><span class="pre">sklearn.metrics.r2_score</span></code></a> for regression.  For some applications,
other scoring functions are better suited (for example in unbalanced
classification, the accuracy score is often uninformative). An alternative
scoring function can be specified via the <code class="docutils literal"><span class="pre">scoring</span></code> parameter to
<a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a>, <a class="reference internal" href="generated/sklearn.grid_search.RandomizedSearchCV.html#sklearn.grid_search.RandomizedSearchCV" title="sklearn.grid_search.RandomizedSearchCV"><code class="xref py py-class docutils literal"><span class="pre">RandomizedSearchCV</span></code></a> and many of the
specialized cross-validation tools described below.
See <a class="reference internal" href="model_evaluation.html#scoring-parameter"><span class="std std-ref">The scoring parameter: defining model evaluation rules</span></a> for more details.
默认地，参数搜索使用 <code class="docutils literal"><span class="pre">score</span></code> 函数来评估估计器参数的取值效果。已经有用于分类的 <a class="reference internal" href="generated/sklearn.metrics.accuracy_score.html#sklearn.metrics.accuracy_score" title="sklearn.metrics.accuracy_score"><code class="xref py py-func docutils literal"><span class="pre">sklearn.metrics.accuracy_score</span></code></a>
和用于回归的 <a class="reference internal" href="generated/sklearn.metrics.r2_score.html#sklearn.metrics.r2_score" title="sklearn.metrics.r2_score"><code class="xref py py-func docutils literal"><span class="pre">sklearn.metrics.r2_score</span></code></a>。一些其他的应用情况下，可能需要特有的函数来计算分数 (例如：在不均衡分类中，
精确度分数通常信息含量不高。) 可以通过给参数 <code class="docutils literal"><span class="pre">scoring</span></code> 设定特有的计算函数来定制 <a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">RandomizedSearchCV`以及</span>
<span class="pre">大部分上面提到的交叉验证工具。阅读</span> <span class="pre">:ref:`scoring_parameter</span></code> 可以得到更多的细节。</p>
</div>
<div class="section" id="composite-estimators-and-parameter-spaces">
<h3>3.2.3.2. Composite estimators and parameter spaces (组合评估器和参数空间)<a class="headerlink" href="#composite-estimators-and-parameter-spaces" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="pipeline.html#pipeline"><span class="std std-ref">Pipeline: chaining estimators</span></a> describes building composite estimators whose
parameter space can be searched with these tools.
<a class="reference internal" href="pipeline.html#pipeline"><span class="std std-ref">Pipeline: chaining estimators</span></a> 描述了构建组合参数估计器以及在组合参数空间中进行搜索的工具。</p>
</div>
<div class="section" id="model-selection-development-and-evaluation">
<h3>3.2.3.3. Model selection: development and evaluation (模型选择：开发和评估)<a class="headerlink" href="#model-selection-development-and-evaluation" title="Permalink to this headline">¶</a></h3>
<p>Model selection by evaluating various parameter settings can be seen as a way
to use the labeled data to “train” the parameters of the grid.
通过评估不同的参数设定来选择模型可以看做是一种带标签的数据来训练 grid 参数的过程。</p>
<p>When evaluating the resulting model it is important to do it on
held-out samples that were not seen during the grid search process:
it is recommended to split the data into a <strong>development set</strong> (to
be fed to the <code class="docutils literal"><span class="pre">GridSearchCV</span></code> instance) and an <strong>evaluation set</strong>
to compute performance metrics.
当进行评估结果模型时，保留一部分样例不在搜索时使用，单独用于评估是非常重要的手段：
建议将数据划分为 <strong>开发集</strong> (<code class="docutils literal"><span class="pre">GridSearchCV</span></code> 实例使用) 和 <strong>评估集</strong> 来衡量结果。</p>
<p>This can be done by using the <code class="xref py py-func docutils literal"><span class="pre">cross_validation.train_test_split</span></code>
utility function.
这个可以通过 <code class="xref py py-func docutils literal"><span class="pre">cross_validation.train_test_split</span></code> 函数实现。</p>
</div>
<div class="section" id="parallelism">
<h3>3.2.3.4. Parallelism (并行化)<a class="headerlink" href="#parallelism" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> and <a class="reference internal" href="generated/sklearn.grid_search.RandomizedSearchCV.html#sklearn.grid_search.RandomizedSearchCV" title="sklearn.grid_search.RandomizedSearchCV"><code class="xref py py-class docutils literal"><span class="pre">RandomizedSearchCV</span></code></a> evaluate each parameter
setting independently.  Computations can be run in parallel if your OS
supports it, by using the keyword <code class="docutils literal"><span class="pre">n_jobs=-1</span></code>. See function signature for
more details.
<a class="reference internal" href="generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV" title="sklearn.grid_search.GridSearchCV"><code class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></code></a> 和 <a class="reference internal" href="generated/sklearn.grid_search.RandomizedSearchCV.html#sklearn.grid_search.RandomizedSearchCV" title="sklearn.grid_search.RandomizedSearchCV"><code class="xref py py-class docutils literal"><span class="pre">RandomizedSearchCV</span></code></a> 独立地评估每个参数。如果使用的 OS 允许，
计算可以并行地进行，设定参数 <code class="docutils literal"><span class="pre">n_jobs=-1</span></code> 来支持这一特性。阅读函数签名来获得更加详细的信息。</p>
</div>
<div class="section" id="robustness-to-failure">
<h3>3.2.3.5. Robustness to failure (失败的鲁棒性)<a class="headerlink" href="#robustness-to-failure" title="Permalink to this headline">¶</a></h3>
<p>Some parameter settings may result in a failure to <code class="docutils literal"><span class="pre">fit</span></code> one or more folds
of the data.  By default, this will cause the entire search to fail, even if
some parameter settings could be fully evaluated. Setting <code class="docutils literal"><span class="pre">error_score=0</span></code>
(or <cite>=np.NaN</cite>) will make the procedure robust to such failure, issuing a
warning and setting the score for that fold to 0 (or <cite>NaN</cite>), but completing
the search.
一些参数的设定可能会引起一个或者多个 fold 拟合的失败。默认地，这将会引起整个搜索的失败，即使
一些参数设定能够被完全求值。设定 <code class="docutils literal"><span class="pre">error_score=0</span></code> (或者 <cite>=np.NaN</cite>) 将会使得过程遇到这种失败时
仍然保持鲁棒性，这会引起 warning，然后设定这个 fold 的分数为 0 或者 <cite>NaN</cite>，但是最终搜索会完成。</p>
</div>
</div>
<div class="section" id="alternatives-to-brute-force-parameter-search">
<span id="alternative-cv"></span><h2>3.2.4. Alternatives to brute force parameter search (暴力参数搜索的替代)<a class="headerlink" href="#alternatives-to-brute-force-parameter-search" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model-specific-cross-validation">
<h3>3.2.4.1. Model specific cross-validation (模型特定的交叉验证)<a class="headerlink" href="#model-specific-cross-validation" title="Permalink to this headline">¶</a></h3>
<p>Some models can fit data for a range of value of some parameter almost
as efficiently as fitting the estimator for a single value of the
parameter. This feature can be leveraged to perform a more efficient
cross-validation used for model selection of this parameter. (一些模型在一些参数取值为某个范围
内训练时其效率和仅训练某单个参数时大致相同。这个特征可以用于提升交叉验证的效率用于基于交叉验证的模型选择)</p>
<p>The most common parameter amenable to this strategy is the parameter
encoding the strength of the regularizer. In this case we say that we
compute the <strong>regularization path</strong> of the estimator.
这种策略常用于正则参数的编码强化。这种情况下，计算估计器的 <strong>regularization path</strong> 。</p>
<p>Here is the list of such models (这种模型的列表如下):</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.linear_model.ElasticNetCV.html#sklearn.linear_model.ElasticNetCV" title="sklearn.linear_model.ElasticNetCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.ElasticNetCV</span></code></a>([l1_ratio,&nbsp;eps,&nbsp;…])</td>
<td>Elastic Net model with iterative fitting along a regularization path</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/sklearn.linear_model.LarsCV.html#sklearn.linear_model.LarsCV" title="sklearn.linear_model.LarsCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.LarsCV</span></code></a>([fit_intercept,&nbsp;…])</td>
<td>Cross-validated Least Angle Regression model</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.linear_model.LassoCV.html#sklearn.linear_model.LassoCV" title="sklearn.linear_model.LassoCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.LassoCV</span></code></a>([eps,&nbsp;n_alphas,&nbsp;…])</td>
<td>Lasso linear model with iterative fitting along a regularization path</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/sklearn.linear_model.LassoLarsCV.html#sklearn.linear_model.LassoLarsCV" title="sklearn.linear_model.LassoLarsCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.LassoLarsCV</span></code></a>([fit_intercept,&nbsp;…])</td>
<td>Cross-validated Lasso, using the LARS algorithm</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.linear_model.LogisticRegressionCV.html#sklearn.linear_model.LogisticRegressionCV" title="sklearn.linear_model.LogisticRegressionCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.LogisticRegressionCV</span></code></a>([Cs,&nbsp;…])</td>
<td>Logistic Regression CV (aka logit, MaxEnt) classifier.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/sklearn.linear_model.MultiTaskElasticNetCV.html#sklearn.linear_model.MultiTaskElasticNetCV" title="sklearn.linear_model.MultiTaskElasticNetCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.MultiTaskElasticNetCV</span></code></a>([…])</td>
<td>Multi-task L1/L2 ElasticNet with built-in cross-validation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.linear_model.MultiTaskLassoCV.html#sklearn.linear_model.MultiTaskLassoCV" title="sklearn.linear_model.MultiTaskLassoCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.MultiTaskLassoCV</span></code></a>([eps,&nbsp;…])</td>
<td>Multi-task L1/L2 Lasso with built-in cross-validation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/sklearn.linear_model.OrthogonalMatchingPursuitCV.html#sklearn.linear_model.OrthogonalMatchingPursuitCV" title="sklearn.linear_model.OrthogonalMatchingPursuitCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.OrthogonalMatchingPursuitCV</span></code></a>([…])</td>
<td>Cross-validated Orthogonal Matching Pursuit model (OMP)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.linear_model.RidgeCV.html#sklearn.linear_model.RidgeCV" title="sklearn.linear_model.RidgeCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.RidgeCV</span></code></a>([alphas,&nbsp;…])</td>
<td>Ridge regression with built-in cross-validation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/sklearn.linear_model.RidgeClassifierCV.html#sklearn.linear_model.RidgeClassifierCV" title="sklearn.linear_model.RidgeClassifierCV"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.RidgeClassifierCV</span></code></a>([alphas,&nbsp;…])</td>
<td>Ridge classifier with built-in cross-validation.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="information-criterion">
<h3>3.2.4.2. Information Criterion (信息规范)<a class="headerlink" href="#information-criterion" title="Permalink to this headline">¶</a></h3>
<p>Some models can offer an information-theoretic closed-form formula of the
optimal estimate of the regularization parameter by computing a single
regularization path (instead of several when using cross-validation).
一些模型通过计算规则路径（而不是使用交叉验证) 可以给出提供在信息理论上可解析的最优规则参数计算公式。</p>
<p>Here is the list of models benefitting from the Aikike Information
Criterion (AIC) or the Bayesian Information Criterion (BIC) for automated
model selection (这是一个可从 AIC 信息准则或者 BIC 信息准则中获益的模型列表):</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.linear_model.LassoLarsIC.html#sklearn.linear_model.LassoLarsIC" title="sklearn.linear_model.LassoLarsIC"><code class="xref py py-obj docutils literal"><span class="pre">linear_model.LassoLarsIC</span></code></a>([criterion,&nbsp;…])</td>
<td>Lasso model fit with Lars using BIC or AIC for model selection</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="out-of-bag-estimates">
<span id="out-of-bag"></span><h3>3.2.4.3. Out of Bag Estimates 实用化的评估<a class="headerlink" href="#out-of-bag-estimates" title="Permalink to this headline">¶</a></h3>
<p>When using ensemble methods base upon bagging, i.e. generating new
training sets using sampling with replacement, part of the training set
remains unused.  For each classifier in the ensemble, a different part
of the training set is left out.
当使用提升方法比如 bagging, 当使用可替代采样重新生成训练集合时，有一部分训练数据集仍然没有使用，
对于提升集合中的每个分类器，一个不同的训练集合被保留出来。</p>
<p>This left out portion can be used to estimate the generalization error
without having to rely on a separate validation set.  This estimate
comes “for free” as no additional data is needed and can be used for
model selection.
留出来的部分可以用于评估泛化误差，而不需要另外依赖于一个单独的验证集合。
这个估计不需要额外的数据，可以用于模型选择。</p>
<p>This is currently implemented in the following classes 在下面的类中实现了这个方法:</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier" title="sklearn.ensemble.RandomForestClassifier"><code class="xref py py-obj docutils literal"><span class="pre">ensemble.RandomForestClassifier</span></code></a>([…])</td>
<td>A random forest classifier.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/sklearn.ensemble.RandomForestRegressor.html#sklearn.ensemble.RandomForestRegressor" title="sklearn.ensemble.RandomForestRegressor"><code class="xref py py-obj docutils literal"><span class="pre">ensemble.RandomForestRegressor</span></code></a>([…])</td>
<td>A random forest regressor.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.ensemble.ExtraTreesClassifier.html#sklearn.ensemble.ExtraTreesClassifier" title="sklearn.ensemble.ExtraTreesClassifier"><code class="xref py py-obj docutils literal"><span class="pre">ensemble.ExtraTreesClassifier</span></code></a>([…])</td>
<td>An extra-trees classifier.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/sklearn.ensemble.ExtraTreesRegressor.html#sklearn.ensemble.ExtraTreesRegressor" title="sklearn.ensemble.ExtraTreesRegressor"><code class="xref py py-obj docutils literal"><span class="pre">ensemble.ExtraTreesRegressor</span></code></a>([n_estimators,&nbsp;…])</td>
<td>An extra-trees regressor.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.ensemble.GradientBoostingClassifier.html#sklearn.ensemble.GradientBoostingClassifier" title="sklearn.ensemble.GradientBoostingClassifier"><code class="xref py py-obj docutils literal"><span class="pre">ensemble.GradientBoostingClassifier</span></code></a>([loss,&nbsp;…])</td>
<td>Gradient Boosting for classification.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/sklearn.ensemble.GradientBoostingRegressor.html#sklearn.ensemble.GradientBoostingRegressor" title="sklearn.ensemble.GradientBoostingRegressor"><code class="xref py py-obj docutils literal"><span class="pre">ensemble.GradientBoostingRegressor</span></code></a>([loss,&nbsp;…])</td>
<td>Gradient Boosting for regression.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
        &copy; 2010 - 2014, scikit-learn developers (BSD License).
      <a href="../_sources/modules/grid_search.rst.txt" rel="nofollow">Show this page source</a>
    </div>
     <div class="rel">
    
    <div class="buttonPrevious">
      <a href="cross_validation.html">Previous
      </a>
    </div>
    
     </div>

    
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-22606712-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    

    <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    <script type="text/javascript"> google.load('search', '1',
        {language : 'en'}); google.setOnLoadCallback(function() {
            var customSearchControl = new
            google.search.CustomSearchControl('016639176250731907682:tjtqbvtvij0');
            customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
            var options = new google.search.DrawOptions();
            options.setAutoComplete(true);
            customSearchControl.draw('cse', options); }, true);
    </script>
  </body>
</html>